<!DOCTYPE html>
<html>
<head>
	<title>Random Ron</title>

	<style type="text/css">
		body {
			margin: 1em auto;
			max-width: 40em;
			width: 88%;
		}
	</style>
</head>
<body>

	<h1>Random Ron</h1>

	<blockquote aria-live="polite"></blockquote>

	<p>
		<button>More Ron</button>
	</p>

	<script>
		const API_ENDPOINT = 'https://ron-swanson-quotes.herokuapp.com/v2/quotes';
        const button = document.querySelector('button');
        const blockquote = document.querySelector('blockquote');
        let quotes = [];

        const handleRequest = () => {
            fetch(API_ENDPOINT)
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    return Promise.reject(response);
                }
            })
            .then(data => {
                if (quotes.slice(-50).indexOf(data[0]) === -1) {
                    blockquote.textContent = data[0];
                    quotes.push(data[0]);
                } else {
                    console.log({
                        duplicate: data[0],
                    })
                    alert('duplicate quote. skip it and generate next one.');
                }
            })
            .catch(error => {
                blockquote.textContent = 'Failed to load a quote';
                console.warn('Somth went wrong.', error);
            });
        };

        button.addEventListener('click', handleRequest);
        handleRequest();
	</script>
</body>
</html>